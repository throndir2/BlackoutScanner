<Window x:Class="BlackoutScanner.Views.AreaSelectorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Select Area"
        ResizeMode="NoResize"
        Topmost="True"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ShowInTaskbar="False">
        <Window.Resources>
                <!-- Override theme styles to ensure transparency -->
                <Style TargetType="Grid">
                        <Setter Property="Background"
                                Value="Transparent"/>
                </Style>
                <Style TargetType="Border">
                        <Setter Property="Background"
                                Value="Transparent"/>
                </Style>
                <Style TargetType="StackPanel">
                        <Setter Property="Background"
                                Value="Transparent"/>
                </Style>
        </Window.Resources>
        <Grid>
                <!-- Transparent canvas for selection -->
                <Canvas x:Name="selectionCanvas"
                        MouseDown="Canvas_MouseDown"
                        MouseMove="Canvas_MouseMove"
                        MouseUp="Canvas_MouseUp"
                        Background="#01000000">
                        <!-- Almost transparent, but still hit-testable -->

                        <!-- Selection rectangle -->
                        <Rectangle x:Name="selectionRectangle"
                                   Stroke="#FFff0000"
                                   StrokeThickness="2"
                                   Fill="#30ff0000"
                                   Visibility="Collapsed">
                                <Rectangle.StrokeDashArray>
                                        <DoubleCollection>5,5</DoubleCollection>
                                </Rectangle.StrokeDashArray>
                        </Rectangle>
                </Canvas>

                <!-- Instructions overlay -->
                <Border Background="#CC000000"
                        VerticalAlignment="Top"
                        HorizontalAlignment="Center"
                        Margin="0,20,0,0"
                        CornerRadius="5"
                        Padding="20,10">
                        <Border.Style>
                                <Style TargetType="Border">
                                        <Setter Property="Background"
                                                Value="#CC000000"/>
                                </Style>
                        </Border.Style>
                        <StackPanel>
                                <TextBlock x:Name="instructionText"
                                           Foreground="White"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           TextAlignment="Center"/>
                                <TextBlock x:Name="coordinateText"
                                           Foreground="White"
                                           FontSize="14"
                                           TextAlignment="Center"
                                           Margin="0,5,0,0"/>
                        </StackPanel>
                </Border>

                <!-- Floating action buttons -->
                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            Margin="0,0,0,50">
                        <Button Content="✓ Confirm (Enter)"
                                Click="Confirm_Click"
                                Margin="5"
                                Padding="15,10"
                                Background="#FF4CAF50"
                                Foreground="White"
                                FontSize="14"
                                FontWeight="Bold"
                                Cursor="Hand">
                                <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="5"
                                                        Padding="{TemplateBinding Padding}">
                                                        <Border.Effect>
                                                                <DropShadowEffect ShadowDepth="2"
                                                                                  Color="Black"
                                                                                  Opacity="0.5"/>
                                                        </Border.Effect>
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                        </ControlTemplate>
                                </Button.Template>
                        </Button>
                        <Button Content="✗ Cancel (Esc)"
                                Click="Cancel_Click"
                                Margin="5"
                                Padding="15,10"
                                Background="#FFF44336"
                                Foreground="White"
                                FontSize="14"
                                FontWeight="Bold"
                                Cursor="Hand">
                                <Button.Template>
                                        <ControlTemplate TargetType="Button">
                                                <Border Background="{TemplateBinding Background}"
                                                        CornerRadius="5"
                                                        Padding="{TemplateBinding Padding}">
                                                        <Border.Effect>
                                                                <DropShadowEffect ShadowDepth="2"
                                                                                  Color="Black"
                                                                                  Opacity="0.5"/>
                                                        </Border.Effect>
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                          VerticalAlignment="Center"/>
                                                </Border>
                                        </ControlTemplate>
                                </Button.Template>
                        </Button>
                </StackPanel>
        </Grid>
</Window>
