<Window x:Class="BlackoutScanner.Views.ProfileEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:BlackoutScanner"
        xmlns:converters="clr-namespace:BlackoutScanner.Converters"
        mc:Ignorable="d"
        Title="Game Profile Editor"
        Height="700"
        Width="900"
        Background="{DynamicResource BackgroundBrush}">
    <Window.Resources>
        <converters:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
    </Window.Resources>
    <Grid Margin="10"
          Background="{DynamicResource BackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0"
                    Margin="0,0,0,10">
            <TextBlock Text="Profile Name:"
                       FontWeight="Bold"/>
            <TextBox x:Name="profileNameTextBox"
                     Margin="0,5,0,0"/>
            <TextBlock Text="Game Window Title:"
                       FontWeight="Bold"
                       Margin="0,10,0,0"/>
            <Grid Margin="0,5,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="gameTitleTextBox"
                         Grid.Column="0"/>
                <Button Content="Search..."
                        Grid.Column="1"
                        Click="SearchWindow_Click"
                        Margin="5,0,0,0"
                        Padding="10,2"/>
            </Grid>
        </StackPanel>

        <TabControl x:Name="categoriesTabControl"
                    Grid.Row="1">
            <TabControl.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding Name}"/>
                </DataTemplate>
            </TabControl.ItemTemplate>
            <TabControl.ContentTemplate>
                <DataTemplate>
                    <Grid Margin="5"
                          Background="{DynamicResource BackgroundBrush}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0"
                                    Orientation="Vertical"
                                    Margin="0,0,0,10">
                            <TextBlock Text="Category Name:"
                                       FontWeight="Bold"/>
                            <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged}"
                                     Margin="0,5,0,0"/>
                        </StackPanel>

                        <StackPanel Grid.Row="1"
                                    Orientation="Vertical"
                                    Margin="0,0,0,10">
                            <TextBlock Text="Category Area"
                                       FontWeight="Bold"/>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="Define Category Area"
                                        Click="DefineCategoryArea_Click"
                                        Margin="0,5,10,5"/>
                                <TextBlock Text="X:"
                                           VerticalAlignment="Center"/>
                                <TextBox Text="{Binding Bounds.X}"
                                         Width="50"
                                         Margin="5"/>
                                <TextBlock Text="Y:"
                                           VerticalAlignment="Center"/>
                                <TextBox Text="{Binding Bounds.Y}"
                                         Width="50"
                                         Margin="5"/>
                                <TextBlock Text="Width:"
                                           VerticalAlignment="Center"/>
                                <TextBox Text="{Binding Bounds.Width}"
                                         Width="50"
                                         Margin="5"/>
                                <TextBlock Text="Height:"
                                           VerticalAlignment="Center"/>
                                <TextBox Text="{Binding Bounds.Height}"
                                         Width="50"
                                         Margin="5"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Grid.Row="2"
                                    Margin="0,0,0,10"
                                    Visibility="{Binding PreviewImage, Converter={StaticResource NullToVisibilityConverter}}">
                            <TextBlock Text="Category Preview:"
                                       FontWeight="Bold"
                                       Margin="0,0,0,5"/>
                            <Border BorderBrush="Gray"
                                    BorderThickness="1"
                                    HorizontalAlignment="Left">
                                <Image Source="{Binding PreviewImage}"
                                       MaxHeight="100"
                                       MaxWidth="300"
                                       Stretch="Uniform"/>
                            </Border>
                        </StackPanel>

                        <DataGrid x:Name="fieldsDataGrid"
                                  Grid.Row="3"
                                  ItemsSource="{Binding Fields}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  RowHeight="60"
                                  Background="{DynamicResource ControlBackgroundBrush}"
                                  Foreground="{DynamicResource ForegroundBrush}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Field Name"
                                                    Binding="{Binding Name, UpdateSourceTrigger=PropertyChanged}"
                                                    Width="150"/>
                                <DataGridCheckBoxColumn Header="Key Field"
                                                        Binding="{Binding IsKeyField}"
                                                        Width="70"/>
                                <DataGridTemplateColumn Header="Preview"
                                                        Width="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="LightGray"
                                                    BorderThickness="1"
                                                    Margin="2"
                                                    Visibility="{Binding PreviewImage, Converter={StaticResource NullToVisibilityConverter}}">
                                                <Image Source="{Binding PreviewImage}"
                                                       MaxHeight="50"
                                                       MaxWidth="80"
                                                       Stretch="Uniform"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="Area"
                                                        Width="*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="X:"
                                                           VerticalAlignment="Center"/>
                                                <TextBox Text="{Binding Bounds.X}"
                                                         Width="40"
                                                         Margin="2"/>
                                                <TextBlock Text="Y:"
                                                           VerticalAlignment="Center"/>
                                                <TextBox Text="{Binding Bounds.Y}"
                                                         Width="40"
                                                         Margin="2"/>
                                                <TextBlock Text="W:"
                                                           VerticalAlignment="Center"/>
                                                <TextBox Text="{Binding Bounds.Width}"
                                                         Width="40"
                                                         Margin="2"/>
                                                <TextBlock Text="H:"
                                                           VerticalAlignment="Center"/>
                                                <TextBox Text="{Binding Bounds.Height}"
                                                         Width="40"
                                                         Margin="2"/>
                                                <Button Content="Define"
                                                        Click="DefineFieldAreaButton_Click"
                                                        Tag="{Binding}"
                                                        Margin="5,0,0,0"/>
                                                <Button Content="Remove"
                                                        Click="RemoveField_Click"
                                                        Tag="{Binding}"
                                                        Margin="5,0,0,0"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>

                        <StackPanel Grid.Row="4"
                                    Orientation="Horizontal"
                                    HorizontalAlignment="Left"
                                    Margin="0,10,0,0">
                            <Button Content="Add Field"
                                    Click="AddField_Click"
                                    Margin="5"/>
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </TabControl.ContentTemplate>
        </TabControl>

        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,10,0,0">
            <Button Content="Add Category"
                    Click="AddCategory_Click"
                    Margin="5"/>
            <Button Content="Remove Category"
                    Click="RemoveCategory_Click"
                    Margin="5"/>
            <Button Content="Save"
                    Click="Save_Click"
                    IsDefault="True"
                    Margin="20,5,5,5"
                    Padding="10,5"/>
            <Button Content="Cancel"
                    Click="Cancel_Click"
                    IsCancel="True"
                    Margin="5"
                    Padding="10,5"/>
        </StackPanel>
    </Grid>
</Window>
